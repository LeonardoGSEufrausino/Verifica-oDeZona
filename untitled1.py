# -*- coding: utf-8 -*-
"""Untitled1.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1G-FeCGD3eoTSYETnkIF7iu6l4bZX4EDJ
"""

# Importando bibliotecas necess√°rias
import pandas as pd
import numpy as np


# Carregando os dados da planilha
url = '/content/Quadro_3_Parametros_Ocupacao finalizada.csv'
data = pd.read_csv(url, sep=';')

# Limpeza e prepara√ß√£o dos dados
data['C.A. Maximo'] = data['C.A. Maximo'].astype(str).str.replace(r'[^0-9.,]+', '', regex=True)
data['C.A. Maximo'] = data['C.A. Maximo'].str.replace(',', '.')
data['C.A. Maximo'] = pd.to_numeric(data['C.A. Maximo'], errors='coerce')

data['T.O. at√© 500m¬≤'] = data['T.O. at√© 500m¬≤'].astype(str).str.replace(r'[^0-9.,]+', '', regex=True)
data['T.O. at√© 500m¬≤'] = data['T.O. at√© 500m¬≤'].str.replace(',', '.')
data['T.O. at√© 500m¬≤'] = pd.to_numeric(data['T.O. at√© 500m¬≤'], errors='coerce')

data['Recuo Frente'] = data['Recuo Frente'].astype(str).str.replace(r'[^0-9.,]+', '', regex=True)
data['Recuo Frente'] = data['Recuo Frente'].str.replace(',', '.')
data['Recuo Frente'] = pd.to_numeric(data['Recuo Frente'], errors='coerce')

data['Recuo ‚â§10m'] = data['Recuo ‚â§10m'].astype(str).str.replace(r'[^0-9.,]+', '', regex=True)
data['Recuo ‚â§10m'] = data['Recuo ‚â§10m'].str.replace(',', '.')
data['Recuo ‚â§10m'] = pd.to_numeric(data['Recuo ‚â§10m'], errors='coerce')

data['Recuo >10m'] = data['Recuo >10m'].astype(str).str.replace(r'[^0-9.,]+', '', regex=True)
data['Recuo >10m'] = data['Recuo >10m'].str.replace(',', '.')
data['Recuo >10m'] = pd.to_numeric(data['Recuo >10m'], errors='coerce')

def validar_entradas(zona, area, medidas):
    # Verificar se a zona existe
    if zona not in data['Zona'].values:
        print(" Erro: Zona n√£o encontrada na planilha.")
        return False

    # Verificar √°rea v√°lida
    if area <= 0:
        print(" Erro: √Årea deve ser maior que zero.")
        return False

    # Verificar medidas v√°lidas
    if any(m <= 0 for m in medidas.values()):
        print(" Erro: Medidas n√£o podem ser zero ou negativas.")
        return False

    return True

def calcular_largura_util(ns_medida, recuo_lateral):
    return ns_medida - (2 * recuo_lateral)

def calcular_profundidade_util(lo_medida, recuo_frontal, recuo_fundo):
    return lo_medida - recuo_frontal - recuo_fundo

def mostrar_resultados(zona, area, medidas):
    try:
        # Filtrar dados da zona
        dados_zona = data[data['Zona'] == zona].iloc[0]

        # Configura√ß√µes da zona
        recuo_frontal = dados_zona['RecuoFrontal']
        recuo_fundo = dados_zona['RecuoFundo']
        recuo_lateral = dados_zona['RecuoLateral']
        taxa_ocupacao = dados_zona['TaxaOcupacao']
        ca_maximo = dados_zona['C.A. Maximo']
        gabarito = dados_zona['Gabarito']
        cota_max = dados_zona['Cota Max. Terreno p/ unidade']

        # C√°lculos principais
        area_ocupada = area * taxa_ocupacao
        area_maxima = area * ca_maximo
        largura_util = calcular_largura_util(medidas['ns'], recuo_lateral)
        profundidade_util = calcular_profundidade_util(medidas['lo'], recuo_frontal, recuo_fundo)
        qtd_unidades = area / cota_max

        # Resultados
        print(f"\n RESULTADOS PARA ZONA {zona}")
        print("======================================")
        print(f"üìè DIMENS√ïES √öTEIS")
        print(f"‚Ä¢ Largura √∫til: {largura_util:.2f}m")
        print(f"‚Ä¢ Profundidade √∫til: {profundidade_util:.2f}m")

        print("\n PAR√ÇMETROS CONSTRUTIVOS")
        print(f"‚Ä¢ Taxa de ocupa√ß√£o: {taxa_ocupacao*100:.2f}%")
        print(f"‚Ä¢ C.A. M√°ximo: {ca_maximo:.2f}")
        print(f"‚Ä¢ Gabarito (altura m√°xima): {gabarito:.2f}m")

        print("\n √ÅREAS")
        print(f"‚Ä¢ √Årea ocupada permitida: {area_ocupada:.2f}m¬≤")
        print(f"‚Ä¢ √Årea m√°xima constru√≠da: {area_maxima:.2f}m¬≤")
        print(f"‚Ä¢ Unidades poss√≠veis: {qtd_unidades:.1f}")

        print("\n RECUOS OBRIGAT√ìRIOS")
        print(f"‚Ä¢ Recuo frontal: {recuo_frontal}m")
        print(f"‚Ä¢ Recuo de fundo: {recuo_fundo}m")
        print(f"‚Ä¢ Recuo lateral: {recuo_lateral}m")
        display(data[['Zona', 'Recuo Frente', 'Recuo ‚â§10m', 'Recuo >10m']])

        print("\n ESTIMATIVA DE INVESTIMENTO")
        investimento = area_maxima * 2500  # R$/m¬≤
        print(f"‚Ä¢ Valor estimado: R$ {investimento:,.2f}")

    except Exception as e:
        print(f"Erro durante os c√°lculos: {str(e)}")

# Entrada de dados
print(" AN√ÅLISE URBAN√çSTICA - SIMULADOR")
print("----------------------------------")
zona = input("Informe a zona: ")
try:
    area = float(input("√Årea total do terreno (m¬≤): "))
    print("\nInforme as medidas reais do terreno:")
    norte_sul = float(input("Medida Norte-Sul (m): "))
    leste_oeste = float(input("Medida Leste-Oeste (m): "))

    # Validar entradas
    medidas = {'ns': norte_sul, 'lo': leste_oeste}
    if validar_entradas(zona, area, medidas):
        mostrar_resultados(zona, area, medidas)
    else:
        print("Execu√ß√£o interrompida devido a dados inv√°lidos.")

except ValueError:
    print("Erro: Insira valores num√©ricos v√°lidos.")